# 七天玩转数据仓库（DWS）

## 数仓发展现状：

​	在金融、电信、零售等多个行业发展迅速
​	体系架构，技术发展成熟
​	不断完善面向业务的场景分析
​	

## 数仓发展趋势：

​	需求多样化
​	管理数据量急剧增大
​	生态化
​	

## 数据仓库数据分层

ODS---贴源层数据的来源方式：业务库

经常会使用Sqoop来抽取，比如每天定时抽取一次。埋点日志系统上系统会打入各种日志，这些日志一般以文件的形式保存，可以选择flume，storm定时抽取

DW---Data Warehouse,数据仓库层。从ODS层获得的数据按照主题建立各种数据模型。需要了解两个概念：维度（Dimension）、事实（Fact）

DM---该层主要是提供数据产品和数据分析使用的数据，一般会存放在mysql等系统中供线上使用，也可能会存在Hive、Druid中供数据分析和数据挖掘使用。比如经常说的报表数据、大宽表一般存放在这里

![image-20210830095952893](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210830095952893.png)

## 数据仓库的数据模型

维度模型（Dimension Modeling）是专门用于分析型数据库、数据仓库、数据集市建模的方法

​		它本身属于一种关系建模方法，但和之前在操作型数据库中介绍的关系建模方式相比增加了两个概念：

​		1、维度（Dimension）

​		表示对分析主题所属类型的描述。比如昨天早上张三在京东花费200元购买了一个皮包。那么以购买为主题进行分析，可从这段信息中提取三个维度：时间维度（昨天早上），地点维度（京东）、商品维度（皮包）。通常来说维度表信息比较固定，切数据量小

​		2、事实表（fact table）		

​		表示对分析主题的度量。比如上面那个例子中，200元就是事实信息。事实表包含了与各维度表相关联的外码，并通过JOIN方式与维度表关联。事实表的度量通常是数值类型，且记录数会不断增加，表规模迅速增长。

![image-20210830101253490](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210830101253490.png)

## 星型模型

星形模型的维度建模由一个事实表和一组维度表组成，且具有以下特点：

​	a.维度表只和事实表关联，维度表之间没有关联

​	b.每个维度表的主码为单列，且该主码放置在事实表中，作为两边连接的外码

​	c.以事实表为核心，维度表围绕核心呈星形分布

星形模型（Star Schema）是最常用的维度建模方式，以下图展示了使用星形模式进行维度建模的关系结构：

![image-20210830101826555](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210830101826555.png)

## 雪花模型

星形模式中的维度表 相对雪花模型来说要大，而且不满足规范化设计。雪花模型相当于将星形模型的大维度表拆分成小维表，满足了规范化设计。然而这种模式在实际应用中很少见，因为这样做会导致开发难度增大，而数据冗余问题在数据仓库里并不严重。

雪花模式（Snowflake Schema）是对星形模式的扩展，每个维度表可继续向外连接多个子维度表。下图为使用雪花模式进行维度建模的关系结构：

![image-20210830102332068](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210830102332068.png)

## 星座模型

前面介绍的两种维度建模方法都是多维表对应事实表，但是很多时候维度空间内的事实表不止一个，而一个维表也可能被多个事实表用到。在业务发展后期，绝大部分维度建模都采用星座模型。

星座模式（Fact Constellations Schema）也是星形模式的扩展。基于这种思想就有了星座模式：

![image-20210830102822802](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210830102822802.png)

## 三种模式对比

雪花模型是将星形模式的维表进一步划分，使各维表均满足规范化设计。而星座模式则是运行星形模式中出现多个事实表。

![image-20210830103040421](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210830103040421.png)